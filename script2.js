
const data = {
    "en": [
        {
            "key": "`",
            "id": "Backquote",
            "class": "key change"
        },
        {
            "key": "1",
            "id": "Digit1",
            "class": "key change"
        },
        {
            "key": "2",
            "id": "Digit2",
            "class": "key change"
        },
        {
            "key": "3",
            "id": "Digit3",
            "class": "key change"
        },
        {
            "key": "4",
            "id": "Digit4",
            "class": "key change"
        },
        {
            "key": "5",
            "id": "Digit5",
            "class": "key change"
        },
        {
            "key": "6",
            "id": "Digit6",
            "class": "key change"
        },
        {
            "key": "7",
            "id": "Digit7",
            "class": "key change"
        },
        {
            "key": "8",
            "id": "Digit8",
            "class": "key change"
        },
        {
            "key": "9",
            "id": "Digit9",
            "class": "key change"
        },
        {
            "key": "0",
            "id": "Digit0",
            "class": "key change"
        },
        {
            "key": "-",
            "id": "Minus",
            "class": "key change"
        },
        {
            "key": "=",
            "id": "Equal",
            "class": "key change"
        },
        {
            "key": "<-",
            "id": "Backspace",
            "class": "key dark twokey"
        },
        {
            "key": "Tab",
            "id": "Tab",
            "class": "key dark "
        },
        {
            "key": "q",
            "id": "KeyQ",
            "class": "key  letter change"
        },
        {
            "key": "w",
            "id": "KeyW",
            "class": "key  letter change"
        },
        {
            "key": "e",
            "id": "KeyE",
            "class": "key  letter change"
        },
        {
            "key": "r",
            "id": "KeyR",
            "class": "key  letter change"
        },
        {
            "key": "t",
            "id": "KeyT",
            "class": "key  letter change"
        },
        {
            "key": "y",
            "id": "KeyY",
            "class": "key  letter change"
        },
        {
            "key": "u",
            "id": "KeyU",
            "class": "key  letter change"
        },
        {
            "key": "i",
            "id": "KeyI",
            "class": "key letter  change"
        },
        {
            "key": "o",
            "id": "KeyO",
            "class": "key  letter change"
        },
        {
            "key": "p",
            "id": "KeyP",
            "class": "key letter  change"
        },
        {
            "key": "[",
            "id": "BracketLeft",
            "class": "key  change "
        },
        {
            "key": "]",
            "id": "BracketRight",
            "class": "key  change "
        },
        {
            "key": "\\",
            "id": "Backslash",
            "class": "key  change "
        },
        {
            "key": "Del",
            "id": "NumpadDecimal",
            "class": "key dark "
        },
        {
            "key": "CapsLock",
            "id": "CapsLock",
            "class": "key dark twokey"
        },
        {
            "key": "a",
            "id": "KeyA",
            "class": "key letter change"
        },
        {
            "key": "s",
            "id": "KeyS",
            "class": "key letter change"
        },
        {
            "key": "d",
            "id": "KeyD",
            "class": "key letter change"
        },
        {
            "key": "f",
            "id": "KeyF",
            "class": "key letter change"
        },
        {
            "key": "g",
            "id": "KeyG",
            "class": "key letter change"
        },
        {
            "key": "h",
            "id": "KeyH",
            "class": "key letter change"
        },
        {
            "key": "j",
            "id": "KeyJ",
            "class": "key letter change"
        },
        {
            "key": "k",
            "id": "KeyK",
            "class": "key letter change"
        },
        {
            "key": "l",
            "id": "KeyL",
            "class": "key letter change"
        },
        {
            "key": ";",
            "id": "Semicolon",
            "class": "key change"
        },
        {
            "key": "'",
            "id": "Quote",
            "class": "key change"
        },
        {
            "key": "Enter",
            "id": "Enter",
            "class": "key dark twokey"
        },
        {
            "key": "Shift",
            "id": "ShiftLeft",
            "class": "key dark twokey"
        },
        {
            "key": "z",
            "id": "KeyZ",
            "class": "key letter change"
        },
        {
            "key": "x",
            "id": "KeyX",
            "class": "key letter change"
        },
        {
            "key": "c",
            "id": "KeyC",
            "class": "key letter change"
        },
        {
            "key": "v",
            "id": "KeyV",
            "class": "key letter change"
        },
        {
            "key": "b",
            "id": "KeyB",
            "class": "key letter change"
        },
        {
            "key": "n",
            "id": "KeyN",
            "class": "key letter change"
        },
        {
            "key": "m",
            "id": "KeyM",
            "class": "key letter change"
        },
        {
            "key": ",",
            "id": "Comma",
            "class": "key change"
        },
        {
            "key": ".",
            "id": "Period",
            "class": "key change"
        },
        {
            "key": "/",
            "id": "Slash",
            "class": "key change"
        },
        {
            "key": "/\\",
            "id": "ArrowUp",
            "class": "key"
        },
        {
            "key": "Shift",
            "id": "ShiftRight",
            "class": "key dark twokey"
        },
        {
            "key": "Ctrl",
            "id": "ControlLeft",
            "class": "key dark "
        },
        {
            "key": "Alt",
            "id": "AltLeft",
            "class": "key dark "
        },
        {
            "key": "tabl",
            "id": "Space",
            "class": "key dark tabl"
        },
        {
            "key": "Alt",
            "id": "AltRight",
            "class": "key dark "
        },
        {
            "key": "<-",
            "id": "ArrowLeft",
            "class": "key dark "
        },
        {
            "key": "\\/",
            "id": "ArrowDown",
            "class": "key dark "
        },
        {
            "key": "->",
            "id": "ArrowRight",
            "class": "key dark "
        },
        {
            "key": "Ctrl",
            "id": "ControlRight",
            "class": "key dark "
        }
    ],
    "ru": [
        {
            "key": "ё",
            "id": "Backquote",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "1",
            "id": "Digit1",
            "class": "key change-ru"
        },
        {
            "key": "2",
            "id": "Digit2",
            "class": "key change-ru"
        },
        {
            "key": "3",
            "id": "Digit3",
            "class": "key change-ru"
        },
        {
            "key": "4",
            "id": "Digit4",
            "class": "key change-ru"
        },
        {
            "key": "5",
            "id": "Digit5",
            "class": "key change-ru"
        },
        {
            "key": "6",
            "id": "Digit6",
            "class": "key change-ru"
        },
        {
            "key": "7",
            "id": "Digit7",
            "class": "key change-ru"
        },
        {
            "key": "8",
            "id": "Digit8",
            "class": "key change-ru"
        },
        {
            "key": "9",
            "id": "Digit9",
            "class": "key change-ru"
        },
        {
            "key": "0",
            "id": "Digit0",
            "class": "key change-ru"
        },
        {
            "key": "-",
            "id": "Minus",
            "class": "key "
        },
        {
            "key": "=",
            "id": "Equal",
            "class": "key"
        },
        {
            "key": "<-",
            "id": "Backspace",
            "class": "key dark twokey"
        },
        {
            "key": "Tab",
            "id": "Tab",
            "class": "key dark "
        },
        {
            "key": "й",
            "id": "KeyQ",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "ц",
            "id": "KeyW",
            "class": "key letter-ru  change-ru"
        },
        {
            "key": "у",
            "id": "KeyE",
            "class": "key letter-ru  change-ru"
        },
        {
            "key": "к",
            "id": "KeyR",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "е",
            "id": "KeyT",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "н",
            "id": "KeyY",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "г",
            "id": "KeyU",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "ш",
            "id": "KeyI",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "щ",
            "id": "KeyO",
            "class": "key letter-ru change-ru "
        },
        {
            "key": "з",
            "id": "KeyP",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "х",
            "id": "BracketLeft",
            "class": "key letter-ru  change-ru"
        },
        {
            "key": "ъ",
            "id": "BracketRight",
            "class": "key  letter-ru change-ru"
        },
        {
            "key": "\\",
            "id": "Backslash",
            "class": "key  change "
        },
        {
            "key": "Del",
            "id": "NumpadDecimal",
            "class": "key dark "
        },
        {
            "key": "CapsLock",
            "id": "CapsLock",
            "class": "key dark twokey"
        },
        {
            "key": "ф",
            "id": "KeyA",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "ы",
            "id": "KeyS",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "в",
            "id": "KeyD",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "а",
            "id": "KeyF",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "п",
            "id": "KeyG",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "р",
            "id": "KeyH",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "о",
            "id": "KeyJ",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "л",
            "id": "KeyK",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "д",
            "id": "KeyL",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "ж",
            "id": "Semicolon",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "э",
            "id": "Quote",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "Enter",
            "id": "Enter",
            "class": "key dark twokey"
        },
        {
            "key": "Shift",
            "id": "ShiftLeft",
            "class": "key dark twokey"
        },
        {
            "key": "я",
            "id": "KeyZ",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "ч",
            "id": "KeyX",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "с",
            "id": "KeyC",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "м",
            "id": "KeyV",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "и",
            "id": "KeyB",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "т",
            "id": "KeyN",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "ь",
            "id": "KeyM",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "б",
            "id": "Comma",
            "class": "key letter-ru change-ru"
        },
        {
            "key": "ю",
            "id": "Period",
            "class": "key letter-ru change-ru"
        },
        {
            "key": ".",
            "id": "Slash",
            "class": "key change-ru"
        },
        {
            "key": "/\\",
            "id": "ArrowUp",
            "class": "key dark"
        },
        {
            "key": "Shift",
            "id": "ShiftRight",
            "class": "key dark twokey"
        },
        {
            "key": "Ctrl",
            "id": "ControlLeft",
            "class": "key dark "
        },
        {
            "key": "Alt",
            "id": "AltLeft",
            "class": "key dark "
        },
        {
            "key": "tabl",
            "id": "Space",
            "class": "key dark tabl"
        },
        {
            "key": "Alt",
            "id": "AltRight",
            "class": "key dark "
        },
        {
            "key": "<-",
            "id": "ArrowLeft",
            "class": "key dark "
        },
        {
            "key": "\\/",
            "id": "ArrowDown",
            "class": "key dark "
        },
        {
            "key": "->",
            "id": "ArrowRight",
            "class": "key dark "
        },
        {
            "key": "Ctrl",
            "id": "ControlRight",
            "class": "key dark "
        }
    ],
    "enShift": ["~", "!", "@", "#", "$", "%", "^", "&", "*", "(", ")", "_", "+", "Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P", "{", "}", "|", "A", "S",
        "D", "F", "G", "H", "J", "K", "L", ":", "\"", "Z", "X", "C", "V", "B", "N", "M", "<", ">", "?"],
    "CapsLock": ["Q", "W", "E", "R", "T", "Y", "U", "I", "O", "P", "A", "S", "D", "F", "G", "H", "J", "K", "L", "Z", "X", "C", "V", "B", "N", "M"],
    "ruCapsLock": ["Ё", "Й", "Ц", "У", "К", "Е", "Н", "Г", "Ш", "Щ", "З", "Х", "Ъ", "Ф", "Ы", "В", "А", "П", "Р", "О", "Л", "Д", "Ж", "Э", "Я", "Ч", "С", "М", "И", "Т", "Ь", "Б", "Ю"],
    "enShiftRu": ["Ё", "!", "\"", "№", ";", "%", ":", "?", "*", "(", ")", "Й", "Ц", "У", "К", "Е", "Н", "Г", "Ш", "Щ", "З", "Х", "Ъ", "Ф", "Ы", "В", "А", "П", "Р", "О", "Л", "Д", "Ж", "Э", "Я", "Ч", "С", "М", "И", "Т", "Ь", "Б", "Ю", ","],
};


const { en, ru, enShift, CapsLock, ruCapsLock, enShiftRu } = data;
const body = document.querySelector("body");
const h1 = document.createElement("h1");
const nouteBook = document.createElement("div");
const screen = document.createElement("textarea");
const keyboard = document.createElement("div");
const p = document.createElement("p");
h1.innerHTML = "RSS Virtual Keyboard For Windows OS";
p.innerHTML = "Change Language 'Shift'+'Alt'";
nouteBook.setAttribute("class", "noute-book");
screen.setAttribute("class", "screen");
keyboard.setAttribute("class", "keyboard");

let keyboardBooling = false;
let capsLockBooling = true;
let lenguage = en;


function main() {
    lenguage = localStorage.getItem("len") === "en" ? lenguage = en : lenguage = ru;


    if (!keyboardBooling) { buldkeyboard(lenguage); }

    const keys = document.querySelectorAll(".key");

    document.addEventListener("keydown", (e) => {
        if (e.key === "Tab" || e.key === "Alt") {
            e.preventDefault();
        }
        if (e.code === "CapsLock") {
            document.querySelector("#CapsLock").classList.add("press");
            if (capsLockBooling) {
                e.stopPropagation();
                capsLockBooling = false;
                let letter;
                let letterData;
                if (lenguage === en) {
                    letter = document.querySelectorAll(".letter");
                    letterData = CapsLock;
                } else {
                    letter = document.querySelectorAll(".letter-ru");
                    letterData = ruCapsLock;
                }
                letter.forEach((el, ind) => {
                    el.innerHTML = letterData[ind];
                    // console.log(CapsLock[ind].key);
                });

            }
            else {
                document.querySelector("#CapsLock").classList.add("press");
                capsLockBooling = true;
                while (keyboard.firstChild) {
                    keyboard.removeChild(keyboard.firstChild);
                }
                main();
            }
        }

        if (e.key === "Shift") {
            let change;
            let changeData;
            if (lenguage === en) {
                change = document.querySelectorAll(".change");
                changeData = enShift;
            } else {
                change = document.querySelectorAll(".change-ru");
                changeData = enShiftRu;
            }
            change.forEach((el, ind) => {
                el.innerHTML = changeData[ind];
                // console.log(CapsLock[ind].key);
            });
        }

        presKey(e, keys);
    }, false);


    document.addEventListener("keyup", (e) => {
        upKey(e, keys);
    });

}


function changeLanguage(func, ...keys) {
    let pressed = new Set();

    document.addEventListener("keydown", function (e) {
        pressed.add(e.key);

        for (let key of keys) {
            if (!pressed.has(key)) {
                return;
            }
        }
        pressed.clear();
        func();
    });

    document.addEventListener("keyup", function (e) {
        pressed.delete(e.code);
    });
}

changeLanguage(() => {
    lenguage === en ? lenguage = ru : lenguage = en;
    let len = lenguage === en ? 'en' : 'ru';
    localStorage.setItem("len", len);
    main();
}, "Shift", "Alt");


function buldkeyboard(lenguage) {
    for (let i = 0; i < lenguage.length; i++) {
        const key = document.createElement("div");
        key.setAttribute("class", `${lenguage[i].class}`);
        key.setAttribute("id", `${lenguage[i].id}`);
        key.innerHTML = lenguage[i].key;

        keyboard.append(key);
    }
    nouteBook.append(screen, keyboard);
    body.append(h1, nouteBook, p);

}


function presKey(e, keys) {

    keys.forEach((el) => {
        const keyCode = el.getAttribute("id");

        if (keyCode === e.code) {
            el.classList.add("press");

        }
    });
}


function upKey(e, keys) {
    if (e.key === "Shift") {
        while (keyboard.firstChild) {
            keyboard.removeChild(keyboard.firstChild);
        }
        main();
    }
    keys.forEach((el) => {
        const keyCode = el.getAttribute("id");
        if (keyCode === e.code) {

            el.classList.remove("press");
            el.classList.add("press-up");
            setTimeout(() => {
                el.classList.remove("press-up");
            }, 700);
        }
    });
}



main();











// function onKeys(startKey, ...codes) {
//     let pressed = new Set();

//     document.addEventListener("keydown", (e) => {
//         pressed.add(e.code);

//         for (let code of codes) {
//             if (!pressed.has(code)) {
//                 return;
//             }
//         }
//         pressed.clear();
//         startKey(e);
//     });
//     document.addEventListener("keyup", (e) => {
//         pressed.delete(e.code);
//     });
// }


// onKeys((e) => {
//     // console.log('oooo')
//     keys.forEach((el) => {
//         const keyCode = el.getAttribute("id");

//         if (keyCode === e.code) {
//             el.classList.add("press");
//         }
//     });
// }, "Digit2", "Digit1");